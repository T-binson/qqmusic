$(function(){function s(s){$(".popup-win").css("display","block"),s.css("display","none"),$(".delkey").on("click",function(){s.css("display","block"),$(".popup-win").css("display","none"),$(".btn-del").off("click")}),$(".btn-cel").on("click",function(){s.css("display","block"),$(".popup-win").css("display","none"),$(".btn-del").off("click")})}function e(){return"block"===$(".s-lists").css("display")?$(".s-lists"):"block"===$(".new-lists").css("display")?$(".new-lists"):"block"===$(".rem-lists").css("display")?$(".rem-lists"):void 0}function i(s){$(".btn-del").on("click",function(){$(".popup-win").css("display","none"),$(".s-title .square").removeClass("active"),$(".square").removeClass("active"),e().find(".s-item").remove(),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),clearInterval(Q),clearInterval(R),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",L.css("marginTop",0),s.splice(0,s.length),$(this).off("click")})}function n(s){return"block"===$(".s-lists").css("display")?s?void s(M):M:"block"===$(".new-lists").css("display")?s?void s(re):re:"block"===$(".rem-lists").css("display")?s?void s(ce):ce:void 0}function a(s){$.each(s.splice(0,s.length),function(s,e){e.innerText=s+1})}function t(){var s=e().find(".s-item").eq(S);s.find(".play").addClass("playing"),s.find(".play").addClass("playing"),s.find(".s-num").addClass("wave"),s.find(".s-num").find("b").fadeOut(0),s.find(".song").addClass("actived"),s.find(".s-singer").addClass("actived"),s.find(".icons").css("opacity",1),s.find(".s-time").find("i").css("display","inline-block"),s.find(".s-time").find("span").css("display","none"),L[0].innerHTML="",L.css("marginTop",0),$(".bot .progress").css("backgroundColor","#e9ecef"),b($("audio"),S),R=setInterval(y,0),h(),w(),C(ee,ie,ae,te,S)}function l(){var s=e().find(".s-item .square:not(.active)");$.each(s,function(s,e){return $(e).parent().index()>S?(S=$(e).parent().index(),!1):void 0})}function o(s){var i=0;$.each(e().find(".active"),function(e,n){i=$(n).parent().index()-e,s.splice(i,1)})}function r(s){s.num.addClass("wave").find("b").fadeOut(0),s.song.addClass("actived"),s.singer.addClass("actived"),s.icons.css("opacity","1"),s.time.find("i").css("display","inline-block"),s.time.find("span").css("display","none")}function c(s){s.num.removeClass("wave").find("b").fadeIn(0),s.song.removeClass("actived"),s.singer.removeClass("actived"),s.icons.attr("style",""),s.time.find("i").attr("style",""),s.time.find("span").attr("style","")}function d(){return"block"===$(".s-lists").css("display")?[$(".new-lists"),$(".rem-lists")]:"block"===$(".new-lists").css("display")?[$(".s-lists"),$(".rem-lists")]:"block"===$(".rem-lists").css("display")?[$(".new-lists"),$(".s-lists")]:void 0}function p(s,e,i,n){var a;f(M)?a=$(".s-lists"):f(re)?a=$(".new-lists"):f(ce)&&(a=$(".rem-lists")),a.find(".play").eq(e).removeClass("playing");var t={num:a.find(".s-num").eq(e),song:a.find(".song").eq(e),singer:a.find(".s-singer").eq(e),icons:a.find(".icons").eq(e),time:a.find(".s-time").eq(e)};if(c(t),L[0].innerHTML="",L.css("marginTop",0),$(".bot .progress").css("backgroundColor","#e9ecef"),s.hasClass("mode2")){if(e>=i-1)return n[0].pause(),clearInterval(Q),clearInterval(R),void $(".play-key .pause").removeClass("played");S+=1}else s.hasClass("mode0")?e>=i-1?S=0:S+=1:s.hasClass("mode1")?S=e:s.hasClass("mode3")&&(S=g(0,i));b($("audio"),S),R=setInterval(y,0),h(),w(),C(ee,ie,ae,te,S),a.find(".play").eq(S).addClass("playing");var l={num:a.find(".s-num").eq(S),song:a.find(".song").eq(S),singer:a.find(".s-singer").eq(S),icons:a.find(".icons").eq(S),time:a.find(".s-time").eq(S)};r(l)}function g(s,e){return parseInt(Math.random()*(e-s+1))}function m(s){for(var e=0,i=3;s>i;i++)e-=L.find("li").eq(i).height();return e}function u(s,e,i,n){n>s?n=s:0>n&&(n=0),e.css("width",n),i.css("left",n)}function f(s){for(var e,i=/C100(\w+)./g,n=i.exec($("audio").attr("src"))[1],a=0,t=s.length;t>a;a++)if(s[a].data){if(s[a].data.songmid===n){e=!0;break}}else{if(s[a].songmid===n){e=!0;break}e=!1}return e}function v(){if(_=$("audio")[0].duration,curTime=$("audio")[0].currentTime,G=$(".bot .progress").width()*(curTime/_),$(".bot .song-bar").css("width",G),$(".bot .dot").css("left",G),ae[0].innerText=q(curTime),_===curTime){var s;f(M)?s=M.length:f(re)?s=re.length:f(ce)&&(s=ce.length),p($(".mode"),S,s,$("audio"))}-1!==O.indexOf(q(curTime))&&(L.children().removeClass("highlight"),$(L.children()[O.indexOf(q(curTime))]).addClass("highlight"),lihg=L.find(".highlight").index(),window.innerWidth>767?lihg>2&&L.stop().animate({marginTop:m(lihg)-L.find("li").eq(lihg-2).height()},300):lihg>0&&L.stop().animate({marginTop:m(lihg)-L.find("li").eq(lihg-2).height()},300))}function h(){clearInterval(Q);Q=setInterval(v,1e3)}function y(){if($("audio")[0].buffered.length>0){var s=$("audio")[0].buffered,e=s.end(s.length-1);if(e===$("audio")[0].duration)$(".bot .cache-bar").css("width",0),clearInterval(R),$(".bot .progress").css("backgroundColor","rgba(0,0,0,0.15)");else{if(s===Z)return;Z=s;var i=e/$("audio")[0].duration,n=$(".bot .progress").width()*i;$(".bot .cache-bar").css("width",n)}}}function b(s,e,i){"block"===$(".playing").parentsUntil(".m-lists").eq(7).css("display")&&$("audio").attr("src","");var a;$("audio").attr("src")?f(M)?a=M[e].songmid:f(re)?a=re[e].data.songmid:f(ce)&&(a=ce[e].data.songmid):a=n()[e].data?n()[e].data.songmid:n()[e].songmid;var t="https://dl.stream.qqmusic.qq.com/C100"+a+".m4a?fromtag=0&guid=126548448";s.attr("src",t),i&&(s[0].currentTime=i),s[0].play()}function w(){var s="",e=/C100(\w+)./g,i=e.exec($("audio").attr("src"))[1];$.ajax({url:"https://api.hibai.cn/music/Qmusic/Music?id="+i+"&type=lrc",type:"GET",dataType:"text",success:function(e){var i=/(\d*:\d*)\.\d*\](.*)/g,n=e.match(i);O=[],H=[],J=[];for(var a=0;a<n.length;a++){var t=n[a].split("]");t[1]&&(J.push(t[0]),O.push(t[0].split(".")[0]),H.push(t[1]))}for(var l=0;l<O.length;l++)s+="<li>"+H[l]+"</li>";L[0].innerHTML=s,k(J),J.splice(0,J.length/2)},error:function(s){console.log(s)}})}function C(s,e,i,a,t,l){var o;$("audio").attr("src")?f(M)?o=M[t]:f(re)?o=re[t].data:f(ce)&&(o=ce[t].data):o=n()[t].data?n()[t].data:n()[t],s.html(o.songname),$("title").html(o.songname+" - "+x(o.singer)),e.html(x(o.singer)),ne.innerText=o.albumname;var r="https://y.gtimg.cn/music/photo_new/T002R300x300M000"+o.albummid+".jpg?max_age=2592000";se.attr("src",r),le.css("backgroundImage","url("+r+")"),ae[0].innerText=l?q(l):"00:00",te[0].innerText=q(o.interval)}function q(s){var e=parseInt(s/60);10>e&&(e="0"+e);var i=parseInt(s%60);return 10>i&&(i="0"+i),e+":"+i}function k(s){$.each(s,function(e,i){s.push(Number(60*Number(i.slice(0,2))+Number(i.slice(3,5))+i.slice(5)))})}function x(s){for(var e="",i=0,n=s.length-1;n>i;i++)e+=s[i].name+",";return e+=s[n].name}function T(s,e,i){$(e).css("display","block"),$.ajax({url:s,type:"get",dataType:"jsonp",jsonp:"jsonpCallback",scriptCharset:"GBK",beforeSend:function(){$(".loading").css("display","block")},success:function(s){$(".loading").css("display","none"),i=s.songlist;for(var n=i.length,a="",t=0;n>t;t++){var l='<li class="s-item"><span class="square"></span><div class="row"><div class="s-name col-7 col-md-7"><div><i class="s-num"><b>'+(t+1)+'</b></i><p class="song">'+i[t].data.songname+'</p></div><ul class="icons"><li><a href="javascript:;" class="play"></a></li><li><a href="javascript:;" class="download"></a></li><li><a href="javascript:;" class="add"></a></li><li><a href="javascript:;" class="share"></a></li></ul></div><div class="s-singer col-3 col-md-3">'+x(i[t].data.singer)+'</div><div class="s-time col-2 col-md-2"><i class="del"></i><span class="duration">'+q(i[t].data.interval)+"</span></div></div></li>";a+=l}".new-lists"===e?($(e+" #mCSB_2_container").append($(a)),re=i):".rem-lists"===e&&($(e+" #mCSB_3_container").append($(a)),ce=i)},error:function(){console.log("error")}})}function I(){$(".keywords").val()&&(de=$(".keywords").val().trim(),$.ajax({url:oe.search(de),type:"get",dataType:"jsonp",jsonp:"jsonpCallback",scriptCharset:"GBK",statusCode:{404:function(){alert("the page not found!")}},beforeSend:function(){$(".loading").css("display","block")},success:function(s){if($(".loading").css("display","none"),0===s.data.song.list.length)return $(".searchlist").slideDown(),void $(".searchlist").html('<li class="s-tip"><span>暂无搜索结果</span><span class="shutdown"></span></li>');songlist=s.data.song.list;for(var e=songlist.length,i="",n=0;e>n;n++){var a='<li><span class="s-li">'+(songlist[n].songname+"-"+x(songlist[n].singer))+'</span><span class="join"></span></li>';i+=a}i='<li class="s-tip"><span>以下为相关搜索结果:</span><span class="shutdown"></span></li><li><ul data-mcs-theme="minimal">'+i+"</ul></li>",$(".searchlist").html(""),$(".searchlist").append($(i)).slideDown(),$(".searchlist li ul").mCustomScrollbar(),i="",pe=songlist},error:function(){console.log("error")}}))}function j(s,e){if(0!==s.length){if(".s-lists"===e)for(var i=0,n=s.length,a="";n>i;i++){var t='<li class="s-item"><span class="square"></span><div class="row"><div class="s-name col-7 col-md-7"><div><i class="s-num"><b>'+(i+1)+'</b></i><p class="song">'+s[i].songname+'</p></div><ul class="icons"><li><a href="javascript:;" class="play"></a></li><li><a href="javascript:;" class="download"></a></li><li><a href="javascript:;" class="add"></a></li><li><a href="javascript:;" class="share"></a></li></ul></div><div class="s-singer col-3 col-md-3">'+x(s[i].singer)+'</div><div class="s-time col-2 col-md-2"><i class="del"></i><span class="duration">'+q(s[i].interval)+"</span></div></div></li>";a+=t}else for(var i=0,n=s.length,a="";n>i;i++){var t='<li class="s-item"><span class="square"></span><div class="row"><div class="s-name col-7 col-md-7"><div><i class="s-num"><b>'+(i+1)+'</b></i><p class="song">'+s[i].data.songname+'</p></div><ul class="icons"><li><a href="javascript:;" class="play"></a></li><li><a href="javascript:;" class="download"></a></li><li><a href="javascript:;" class="add"></a></li><li><a href="javascript:;" class="share"></a></li></ul></div><div class="s-singer col-3 col-md-3">'+x(s[i].data.singer)+'</div><div class="s-time col-2 col-md-2"><i class="del"></i><span class="duration">'+q(s[i].data.interval)+"</span></div></div></li>";a+=t}$($(e).children()[0].children).append($(a));var l=window.location.hash;"newlists"===l.slice(1)?($(".s-lists").css("display","none"),$(".rem-lists").css("display","none"),$(".new-lists").css("display","block")):"remlists"===l.slice(1)?($(".s-lists").css("display","none"),$(".new-lists").css("display","none"),$(".rem-lists").css("display","block")):($(".new-lists").css("display","none"),$(".rem-lists").css("display","none"),$(".s-lists").css("display","block"))}}$(".s-lists").mCustomScrollbar(),$(".new-lists").mCustomScrollbar(),$(".rem-lists").mCustomScrollbar(),window.location.hash=window.location.hash||"playlist";var S,_,N,O=[],M=[],H=[],J=[],L=$(".m-lrc ul");$(".m-lists").delegate(".square","click",function(){$(this).toggleClass("active"),"s-title"===$(this).parent().attr("class")?$(this).hasClass("active")?$(".square").addClass("active"):$(".square").removeClass("active"):$("ul[data-mcs-theme] .square").length===$("ul[data-mcs-theme] .active").length?$(".s-title .square").addClass("active"):$(".s-title .square").removeClass("active")}),$(".navbar .empty").click(function(){0!==e().find(".s-item").length&&(s($(".remove")),n(i))}),$(".navbar .delete").click(function(){var r=e();if(0!==r.find(".s-item").length&&$(".square").hasClass("active"))return s($(".clear")),r.find(".s-title .square").hasClass("active")?void n(i):void(r.find(".s-item .square").hasClass("active")&&$(".btn-del").on("click",function(){if($(".popup-win").css("display","none"),$(".clear").css("display","block"),r.find(".active").siblings().find(".play").hasClass("playing")){if(1===r.find(".s-item").length)return r.find(".active").parent().remove(),$(".square").removeClass("active"),n(o),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),clearInterval(Q),clearInterval(R),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);S=$(".playing").parentsUntil("ul[data-mcs-theme]").eq(4).index();var s=S;if(S===r.find(".s-item").length-1){if($(".mode").hasClass("mode0"))S=0;else{if(!$(".mode").hasClass("mode3"))return r.find(".active").parent().remove(),$(".square").removeClass("active"),n(o),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),clearInterval(Q),clearInterval(R),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);S=g(1,r.find(".s-item").length-2)}clearInterval(R),t(),n(o)}else l(),S===s&&(S=0),t(),n(o),clearInterval(R)}else{if(1===r.find(".s-item").length)return r.find(".active").parent().remove(),$(".square").removeClass("active"),n(o),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);if(S){var e=n()[S];n(o),-1===n().indexOf(e)?(s=S,l(),S===s&&(S=0)):S=n().indexOf(e)}else n(o)}r.find(".active").parent().remove(),$(".square").removeClass("active");var i=r.find(".s-num b");a(i),$(".s-item").find(".play").hasClass("playing")&&(S=$(".playing").parentsUntil("ul[data-mcs-theme]").eq(4).index()),$(this).off("click")}))}),$(".m-lists").delegate(".del","click",function(){var s=$(this).parentsUntil("ul[data-mcs-theme]").eq(2),e=s.siblings().find("b");if(s.find(".play").hasClass("playing")){if(S=$(".playing").parentsUntil("ul[data-mcs-theme]").eq(4).index(),0===e.length)return s.remove(),n().splice(s.index(),1),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),clearInterval(Q),clearInterval(R),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);if(S===e.length)if($(".mode").hasClass("mode0"))S=0;else{if(!$(".mode").hasClass("mode3"))return s.remove(),n().splice(s.index(),1),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),clearInterval(Q),clearInterval(R),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);S=g(1,e.length-2)}else S+=1;clearInterval(R),t()}else if(0===e.length)return s.remove(),n().splice(s.index(),1),ee.text(""),ie.text(""),ae[0].innerText="00:00",te[0].innerText="00:00",ne.innerText="",se.attr("src","images/cover10.png"),le.css({backgroundImage:"url(images/cover10.png)",transition:"all 1s"}),$(".bot .song-bar").css("width",0),$(".bot .cache-bar").css("width",0),$(".bot .dot").css("left",0),L[0].innerHTML="",void L.css("marginTop",0);n().splice(s.index(),1),s.remove(),a(e),$(".s-item").find(".play").hasClass("playing")&&(S=$(".playing").parentsUntil("ul[data-mcs-theme]").eq(4).index())});var U;$(".m-lists").delegate(".play","click",function(){var s=d();$.each(s,function(s,e){var i={num:e.find(".s-num"),song:e.find(".song"),singer:e.find(".s-singer"),icons:e.find(".icons"),time:e.find(".s-time")};i.icons.find(".playing").removeClass("playing"),c(i)}),$(this).toggleClass("playing"),S=$(this).parentsUntil("ul[data-mcs-theme]").eq(4).index();var e=$(this).parentsUntil(".row"),i=e.eq(2),n={num:i.find(".s-num"),icons:e.eq(1),song:i.find(".song"),singer:i.siblings(".s-singer"),time:i.siblings(".s-time")};$(this).hasClass("playing")?(r(n),$(".play-key .pause").addClass("played"),S!==U&&(N=0,L.css("marginTop",0)),b($("audio"),S,N),R=setInterval(y,0),h(),w(),C(ee,ie,ae,te,S,N)):(c(n),$(".play-key .pause").removeClass("played"),$("audio")[0].pause(),N=$("audio")[0].currentTime,U=S,clearInterval(Q));var a=$(this).parentsUntil("ul[data-mcs-theme]").eq(4).siblings(),t={num:a.find(".s-num"),song:a.find(".song"),singer:a.find(".s-singer"),icons:a.find(".icons"),time:a.find(".s-time")};a.find(".play").removeClass("playing"),c(t)}),$(".play-key .pause").click(function(){var s,i;if($("audio").attr("src")?f(M)?(s=M.length,i=$(".s-lists")):f(re)?(s=re.length,i=$(".new-lists")):f(ce)&&(s=ce.length,i=$(".rem-lists")):(s=n().length,i=e()),0!==s){S>s-1&&(S=0),$(this).toggleClass("played");var a;if($(this).hasClass("played")){if(void 0===S){var t=e();t.find(".play").eq(0).addClass("playing"),R=setInterval(y,0);var l={num:t.find(".s-num").eq(0),song:t.find(".song").eq(0),singer:t.find(".s-singer").eq(0),icons:t.find(".icons").eq(0),time:t.find(".s-time").eq(0)};r(l),S=0,a=t.find(".s-item").eq(0)}else{a=i.find(".s-item").eq(S),a.find(".play").addClass("playing");var o={num:a.find(".s-num"),song:a.find(".song"),singer:a.find(".s-singer"),icons:a.find(".icons"),time:a.find(".s-time")};r(o)}b($("audio"),S,N),h(),w(),C(ee,ie,ae,te,S,N)}else{i.find(".play").removeClass("playing");var d={num:i.find(".s-num"),song:i.find(".song"),singer:i.find(".s-singer"),icons:i.find(".icons"),time:i.find(".s-time")};c(d),$("audio")[0].pause(),N=$("audio")[0].currentTime,clearInterval(Q)}}}),$(".play-key .pre").click(function(){if($(".play-key .pause").hasClass("played")&&1!==$(".s-item").length&&!(0>S)){var s=$(".s-lists").find(".s-item").length,e=$(".new-lists").find(".s-item").length,i=$(".rem-lists").find(".s-item").length;if(!(1===s&&1===e&&0===i||1===s&&0===e&&1===i||0===s&&1===e&&1===i||1===s&&1===e&&1===i)){var n,a;f(M)?(n=M.length,a=$(".s-lists")):f(re)?(n=re.length,a=$(".new-lists")):f(ce)&&(n=ce.length,a=$(".rem-lists")),a.find(".play").eq(S).removeClass("playing");var t={num:a.find(".s-num").eq(S),song:a.find(".song").eq(S),singer:a.find(".s-singer").eq(S),icons:a.find(".icons").eq(S),time:a.find(".s-time").eq(S)};c(t),L[0].innerHTML="",L.css("marginTop",0),clearInterval(R),$(".bot .progress").css("backgroundColor","#e9ecef"),0===S?S=n-1:S>n-1?S=0:S-=1,a.find(".play").eq(S).addClass("playing");var l={num:a.find(".s-num").eq(S),song:a.find(".song").eq(S),singer:a.find(".s-singer").eq(S),icons:a.find(".icons").eq(S),time:a.find(".s-time").eq(S)};r(l),b($("audio"),S),R=setInterval(y,0),h(),w(),C(ee,ie,ae,te,S)}}}),$(".play-key .next").click(function(){if($(".play-key .pause").hasClass("played")&&1!==$(".s-item").length&&!(0>S)){var s=$(".s-lists").find(".s-item").length,e=$(".new-lists").find(".s-item").length,i=$(".rem-lists").find(".s-item").length;if(!(1===s&&1===e&&0===i||1===s&&0===e&&1===i||0===s&&1===e&&1===i||1===s&&1===e&&1===i)){var n,a;f(M)?(n=M.length,a=$(".s-lists")):f(re)?(n=re.length,a=$(".new-lists")):f(ce)&&(n=ce.length,a=$(".rem-lists")),a.find(".play").eq(S).removeClass("playing"),$(".bot .progress").css("backgroundColor","#e9ecef");var t={num:a.find(".s-num").eq(S),song:a.find(".song").eq(S),singer:a.find(".s-singer").eq(S),icons:a.find(".icons").eq(S),time:a.find(".s-time").eq(S)};c(t),L[0].innerHTML="",L.css("marginTop",0),clearInterval(R),S>=n-1?S=0:S+=1,a.find(".play").eq(S).addClass("playing");var l={num:a.find(".s-num").eq(S),song:a.find(".song").eq(S),singer:a.find(".s-singer").eq(S),icons:a.find(".icons").eq(S),time:a.find(".s-time").eq(S)};r(l),b($("audio"),S),R=setInterval(y,0),h(),w(),C(ee,ie,ae,te,S)}}});var D=["mode0","mode1","mode2","mode3"],B=["列表循环","单曲循环","顺序播放","随机播放"],P=0,X=D.length;$(".mode").click(function(){var s=$(this);D.forEach(function(e,i){s.hasClass(e)&&(s.removeClass(e),P=i)}),P++,P>X-1&&(P=0),s.addClass(D[P]),s.find("span").text(B[P]).stop().fadeIn(500).fadeOut(1e3)}),$(".dislike").click(function(){$(this).toggleClass("like")}),$(".pure").click(function(){$(this).toggleClass("pureon"),$(".m-lrc").toggleClass("fullpage"),$(".m-lrc div").toggleClass("wrapper"),lihg=L.find(".highlight").index(),window.innerWidth>767?lihg>2&&L.stop().animate({marginTop:m(lihg)-L.find("li").eq(lihg-2).height()},300):lihg>0&&L.stop().animate({marginTop:m(lihg)-L.find("li").eq(lihg-2).height()},300)}),$(".horn").click(function(){$(this).toggleClass("silent"),$("audio")[0].muted=!$("audio")[0].muted});var G,E=$(".bot .progress").offset().left,K=$(".bot .progress").width(),W=0;$(".bot").click(function(s){if(s.stopPropagation(),s.preventDefault(),void 0!==S){clearInterval(Q),E=$(".bot .progress").offset().left,K=$(".bot .progress").width(),G=s.pageX-E,u(K,$(".bot .song-bar"),$(".bot .dot"),G),W=G/K,$("audio")[0].currentTime=$("audio")[0].duration*W,N=$("audio")[0].duration*W,ae[0].innerText=q($("audio")[0].duration*W);var e,i=L.children();i.removeClass("highlight"),$.each(J,function(s,i){return i>=$("audio")[0].duration*W?(e=s,!1):void 0}),i.eq(e).addClass("highlight"),e>2?L.stop().animate({marginTop:m(e)-L.find("li").eq(e-2).height()},500):L.stop().animate({marginTop:0},500),$(".pause").hasClass("played")&&h()}});var z=!1;$(".dot").on("mousedown",function(s){s.preventDefault(),s.stopPropagation(),void 0!==S&&(clearInterval(Q),E=$(".bot .progress").offset().left,K=$(".bot .progress").width(),z=!0,$(document).off("mousemove").on("mousemove",function(s){G=s.pageX-E,u(K,$(".bot .song-bar"),$(".bot .dot"),G),W=G/K,W>1?W=1:0>W&&(W=0),ae[0].innerText=q($("audio")[0].duration*W);var e,i=L.children();i.removeClass("highlight"),$.each(J,function(s,i){return i>=$("audio")[0].duration*W?(e=s,!1):void 0}),i.eq(e).addClass("highlight"),e>2?L.stop().animate({marginTop:m(e)-L.find("li").eq(e-2).height()},500):L.stop().animate({marginTop:0},500)}))}),$(document).off("mouseup").on("mouseup",function(){$(document).off("mousemove"),z&&($("audio")[0].currentTime=$("audio")[0].duration*W,N=$("audio")[0].duration*W,z=!1,$(".pause").hasClass("played")&&h())});var Q,R,Z,A,F,V,Y;$(".volume-progress").click(function(s){s.stopPropagation(),s.preventDefault(),A=$(".volume .progress").width(),F=$(".volume .progress").offset().left,Y=s.pageX-F,u(A,$(".volume .progress-bar"),$(".vol-dot"),Y),V=Y/A,$("audio")[0].volume=V}),$(".vol-dot").on("mousedown",function(s){s.preventDefault(),s.stopPropagation(),A=$(".volume .progress").width(),F=$(".volume .progress").offset().left,$(document).off("mousemove").on("mousemove",function(s){Y=s.pageX-F,u(A,$(".volume .progress-bar"),$(".volume .vol-dot"),Y),V=Y/A,V>1?V=1:0>V&&(V=0),$("audio")[0].volume=V})});var se=$(".cover img"),ee=$(".curName"),ie=$(".curSinger"),ne=$(".album")[0],ae=$(".ct"),te=$(".tt"),le=$(".mask-bg"),oe={pop:"https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg?tpl=3&page=detail&date=2018-06-26&topid=4&type=top&song_begin=0&song_num=30&g_tk=5381&jsonpCallback=MusicJsonCallbacktoplist&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0",newest:"https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg?g_tk=5381&uin=0&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&tpl=3&page=detail&type=top&topid=27&_=1519963122923",recommend:"https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg?g_tk=5381&uin=0&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&tpl=3&page=detail&type=top&topid=36&_=1520777874472",search:function(s){return"https://c.y.qq.com/soso/fcgi-bin/search_for_qq_cp?g_tk=5381&uin=0&format=jsonp&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&w="+s+"&zhidaqu=1&catZhida=1&t=0&flag=1&ie=utf-8&sem=1&aggr=0&perpage=20&n=20&p=1&remoteplace=txt.mqq.all&_=1520833663464"}},re=[],ce=[];$(".collect").click(function(){return window.location.hash="newlists",$(".s-lists").css("display","none"),$(".rem-lists").css("display","none"),re.length>0?void $(".new-lists").css("display","block"):void T(oe.newest,".new-lists",re)}),$(".add").click(function(){return window.location.hash="remlists",$(".s-lists").css("display","none"),$(".new-lists").css("display","none"),ce.length>0?void $(".rem-lists").css("display","block"):void T(oe.recommend,".rem-lists",ce)}),$(".down").click(function(){window.location.hash="playlist",$(".rem-lists").css("display","none"),$(".new-lists").css("display","none"),$(".s-lists").css("display","block")});var de;$(".searchbtn").click(function(){I()}),$(document).on("keydown",function(s){13===s.keyCode&&(s.preventDefault(),I())});var pe=[];$(".searchlist").delegate(".join","click",function(){var s=$(".s-lists").find(".s-item").length,e='<li class="s-item"><span class="square"></span><div class="row"><div class="s-name col-7 col-md-7"><div><i class="s-num"><b>'+(s+1)+'</b></i><p class="song">'+pe[$(this).parent().index()].songname+'</p></div><ul class="icons"><li><a href="javascript:;" class="play"></a></li><li><a href="javascript:;" class="download"></a></li><li><a href="javascript:;" class="add"></a></li><li><a href="javascript:;" class="share"></a></li></ul></div><div class="s-singer col-3 col-md-3">'+x(pe[$(this).parent().index()].singer)+'</div><div class="s-time col-2 col-md-2"><i class="del"></i><span class="duration">'+q(pe[$(this).parent().index()].interval)+"</span></div></div></li>";$(".s-lists #mCSB_1_container").append($(e)),M.push(pe[$(this).parent().index()]),window.sessionStorage.setItem("playlist",JSON.stringify(M))}),$(".searchlist").delegate(".shutdown","click",function(){$(".searchlist").slideUp(),$(".keywords").val("")}),window.onbeforeunload=function(){0===M.length&&0===re.length&&0===ce.length||(window.sessionStorage.setItem("playlist",JSON.stringify(M)),window.sessionStorage.setItem("newlists",JSON.stringify(re)),window.sessionStorage.setItem("remlists",JSON.stringify(ce)),window.sessionStorage.setItem("index",JSON.stringify(S)))},window.onload=function(){var s=JSON.parse(window.sessionStorage.getItem("playlist")),e=JSON.parse(window.sessionStorage.getItem("newlists")),i=JSON.parse(window.sessionStorage.getItem("remlists"));null===s&&null===e&&null===i||0===s.length&&0===e.length&&0===i.length||(M=JSON.parse(window.sessionStorage.getItem("playlist")),re=JSON.parse(window.sessionStorage.getItem("newlists")),ce=JSON.parse(window.sessionStorage.getItem("remlists")),S=Number(window.sessionStorage.getItem("index")),j(M,".s-lists"),j(re,".new-lists"),j(ce,".rem-lists"))}});